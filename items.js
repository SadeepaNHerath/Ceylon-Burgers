let foodItems = {
    "Burgers": [
        {
            "id": "BUR001",
            "name": "Classic Burger (Large)",
            "quantity": 15,
            "price": 1500,
            "discount": null,
            "img_url": "img/BUR001.jpeg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR002",
            "name": "Classic Burger (Regular)",
            "quantity": 15,
            "price": 750,
            "discount": "15%",
            "img_url": "img/BUR002.jpeg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR003",
            "name": "Turkey Burger",
            "quantity": 10,
            "price": 1600,
            "discount": null,
            "img_url": "img/BUR003.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR004",
            "name": "Chicken Burger (Large)",
            "quantity": 15,
            "price": 1400,
            "discount": null,
            "img_url": "img/BUR004.jpeg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR005",
            "name": "Chicken Burger (Regular)",
            "quantity": 15,
            "price": 800,
            "discount": "20%",
            "img_url": "img/BUR005.jpeg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR006",
            "name": "Cheese Burger (Large)",
            "quantity": 10,
            "price": 1000,
            "discount": null,
            "img_url": "img/BUR006.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR007",
            "name": "Cheese Burger (Regular)",
            "quantity": 20,
            "price": 600,
            "discount": null,
            "img_url": "img/BUR007.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR008",
            "name": "Bacon Burger",
            "quantity": 15,
            "price": 650,
            "discount": "15%",
            "img_url": "img/BUR008.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR009",
            "name": "Shawarma Burger",
            "quantity": 15,
            "price": 800,
            "discount": null,
            "img_url": "img/BUR009.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR010",
            "name": "Olive Burger",
            "quantity": 15,
            "price": 1800,
            "discount": null,
            "img_url": "img/BUR010.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR011",
            "name": "Double-Cheese Burger",
            "quantity": 15,
            "price": 1250,
            "discount": "20%",
            "img_url": "img/BUR011.jpeg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR012",
            "name": "Crispy Chicken Burger (Regular)",
            "quantity": 15,
            "price": 1200,
            "discount": null,
            "img_url": "img/BUR012.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR013",
            "name": "Crispy Chicken Burger (Large)",
            "quantity": 15,
            "price": 1600,
            "discount": "10%",
            "img_url": "img/BUR013.jpg",
            "expiration_date": "2025-07-04"
        },
        {
            "id": "BUR014",
            "name": "Paneer Burger",
            "quantity": 15,
            "price": 900,
            "discount": null,
            "img_url": "img/BUR014.jpg",
            "expiration_date": "2025-07-04"
        }
    ],
    "Submarines": [
        {
            "id": "SUB001",
            "name": "Crispy Chicken Submarine (Large)",
            "quantity": 15,
            "price": 2000,
            "discount": null,
            "img_url": "img/SUB001.jpeg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB002",
            "name": "Crispy Chicken Submarine (Regular)",
            "quantity": 15,
            "price": 1500,
            "discount": null,
            "img_url": "img/SUB002.jpg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB003",
            "name": "Chicken Submarine (Large)",
            "quantity": 15,
            "price": 1800,
            "discount": "3%",
            "img_url": "img/SUB003.jpeg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB004",
            "name": "Chicken Submarine (Regular)",
            "quantity": 15,
            "price": 1400,
            "discount": null,
            "img_url": "img/SUB004.jpeg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB005",
            "name": "Grinder Submarine",
            "quantity": 15,
            "price": 2300,
            "discount": null,
            "img_url": "img/SUB005.jpg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB006",
            "name": "Cheese Submarine",
            "quantity": 15,
            "price": 2200,
            "discount": null,
            "img_url": "img/SUB006.jpg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB007",
            "name": "Double Cheese n Chicken Submarine",
            "quantity": 15,
            "price": 1900,
            "discount": "16%",
            "img_url": "img/SUB007.jpeg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB008",
            "name": "Special Horgie Submarine",
            "quantity": 15,
            "price": 2800,
            "discount": null,
            "img_url": "img/SUB008.jpg",
            "expiration_date": "2025-07-15"
        },
        {
            "id": "SUB009",
            "name": "BQ Special Submarine",
            "quantity": 15,
            "price": 3000,
            "discount": null,
            "img_url": "img/SUB009.jpg",
            "expiration_date": "2025-07-15"
        }
    ],
    "Fries": [
        {
            "id": "FR001",
            "name": "Steak Fries (Large)",
            "quantity": 10,
            "price": 1200,
            "discount": null,
            "img_url": "img/FRI001.jpg",
            "expiration_date": "2025-07-20"
        },
        {
            "id": "FR002",
            "name": "Steak Fries (Medium)",
            "quantity": 10,
            "price": 600,
            "discount": null,
            "img_url": "img/FRI002.jpg",
            "expiration_date": "2025-07-20"
        },
        {
            "id": "FR003",
            "name": "French Fries (Large)",
            "quantity": 10,
            "price": 800,
            "discount": null,
            "img_url": "img/FRI003.jpg",
            "expiration_date": "2025-07-20"
        },
        {
            "id": "FR004",
            "name": "French Fries (Medium)",
            "quantity": 10,
            "price": 650,
            "discount": null,
            "img_url": "img/FRI004.jpg",
            "expiration_date": "2025-07-20"
        },
        {
            "id": "FR005",
            "name": "French Fries (Small)",
            "quantity": 10,
            "price": 450,
            "discount": null,
            "img_url": "img/FRI005.jpg",
            "expiration_date": "2025-07-20"
        },
        {
            "id": "FR006",
            "name": "Sweet Potato Fries (Large)",
            "quantity": 10,
            "price": 600,
            "discount": null,
            "img_url": "img/FRI006.jpg",
            "expiration_date": "2025-07-20"
        }
    ],
    "Pasta": [
        {
            "id": "PAS001",
            "name": "Chicken n Cheese Pasta",
            "quantity": 5,
            "price": 1600,
            "discount": "15%",
            "img_url": "img/PAS001.jpg",
            "expiration_date": "2025-07-02"
        },
        {
            "id": "PAS002",
            "name": "Chicken Penne Pasta",
            "quantity": 5,
            "price": 1700,
            "discount": null,
            "img_url": "img/PAS002.jpg",
            "expiration_date": "2025-07-02"
        },
        {
            "id": "PAS003",
            "name": "Ground Turkey Pasta Bake",
            "quantity": 5,
            "price": 2900,
            "discount": "10%",
            "img_url": "img/PAS003.jpg",
            "expiration_date": "2025-07-02"
        },
        {
            "id": "PAS004",
            "name": "Creamy Shrimp Pasta",
            "quantity": 5,
            "price": 2000,
            "discount": null,
            "img_url": "img/PAS004.jpg",
            "expiration_date": "2025-07-02"
        },
        {
            "id": "PAS005",
            "name": "Lemon Butter Pasta",
            "quantity": 5,
            "price": 1950,
            "discount": null,
            "img_url": "img/PAS005.jpg",
            "expiration_date": "2025-07-02"
        },
        {
            "id": "PAS006",
            "name": "Tagliatelle Pasta",
            "quantity": 5,
            "price": 2400,
            "discount": "1%",
            "img_url": "img/PAS006.jpg",
            "expiration_date": "2025-07-02"
        }
    ],
    "Salads": [
        {
            "id": "SAL001",
            "name": "Caesar Salad",
            "quantity": 20,
            "price": 700,
            "discount": null,
            "img_url": "img/SAL001.jpg",
            "expiration_date": "2025-07-10"
        },
        {
            "id": "SAL002",
            "name": "Garden Salad",
            "quantity": 20,
            "price": 600,
            "discount": null,
            "img_url": "img/SAL002.jpg",
            "expiration_date": "2025-07-10"
        },
        {
            "id": "SAL003",
            "name": "Greek Salad",
            "quantity": 20,
            "price": 800,
            "discount": null,
            "img_url": "img/SAL003.jpeg",
            "expiration_date": "2025-07-10"
        },
        {
            "id": "SAL004",
            "name": "Quinoa Salad",
            "quantity": 20,
            "price": 850,
            "discount": null,
            "img_url": "img/SAL004.jpg",
            "expiration_date": "2025-07-10"
        },
        {
            "id": "SAL005",
            "name": "Cobb Salad",
            "quantity": 20,
            "price": 900,
            "discount": null,
            "img_url": "img/SAL005.png",
            "expiration_date": "2025-07-10"
        }
    ],
    "Desserts": [
        {
            "id": "DES001",
            "name": "Chocolate Cake",
            "quantity": 30,
            "price": 500,
            "discount": null,
            "img_url": "img/DES001.jpg",
            "expiration_date": "2025-07-25"
        },
        {
            "id": "DES002",
            "name": "Cheesecake",
            "quantity": 30,
            "price": 600,
            "discount": null,
            "img_url": "img/DES002.jpg",
            "expiration_date": "2025-07-25"
        },
        {
            "id": "DES003",
            "name": "Brownie",
            "quantity": 30,
            "price": 400,
            "discount": null,
            "img_url": "img/DES003.jpg",
            "expiration_date": "2025-07-25"
        },
        {
            "id": "DES004",
            "name": "Ice Cream Sundae",
            "quantity": 30,
            "price": 700,
            "discount": null,
            "img_url": "img/DES004.jpg",
            "expiration_date": "2025-07-25"
        },
        {
            "id": "DES005",
            "name": "Fruit Tart",
            "quantity": 30,
            "price": 650,
            "discount": null,
            "img_url": "img/DES005.jpg",
            "expiration_date": "2025-07-25"
        }
    ],
    "Sides": [
        {
            "id": "SID001",
            "name": "Garlic Bread",
            "quantity": 25,
            "price": 400,
            "discount": null,
            "img_url": "img/SID001.jpg",
            "expiration_date": "2025-07-18"
        },
        {
            "id": "SID002",
            "name": "Onion Rings",
            "quantity": 25,
            "price": 450,
            "discount": null,
            "img_url": "img/SID002.jpg",
            "expiration_date": "2025-07-18"
        },
        {
            "id": "SID003",
            "name": "Coleslaw",
            "quantity": 25,
            "price": 350,
            "discount": null,
            "img_url": "img/SID003.jpg",
            "expiration_date": "2025-07-18"
        },
        {
            "id": "SID004",
            "name": "Potato Wedges",
            "quantity": 25,
            "price": 550,
            "discount": null,
            "img_url": "img/SID004.jpg",
            "expiration_date": "2025-07-18"
        },
        {
            "id": "SID005",
            "name": "Stuffed Mushrooms",
            "quantity": 25,
            "price": 600,
            "discount": null,
            "img_url": "img/SID005.jpg",
            "expiration_date": "2025-07-18"
        }
    ],
    "Beverages": [
        {
            "id": "BEV001",
            "name": "Soft Drink (Coke)",
            "quantity": 100,
            "price": 200,
            "discount": null,
            "img_url": "img/BEV001.jpg",
            "expiration_date": "2025-08-01"
        },
        {
            "id": "BEV002",
            "name": "Lemonade",
            "quantity": 100,
            "price": 250,
            "discount": null,
            "img_url": "img/BEV002.jpg",
            "expiration_date": "2025-08-01"
        },
        {
            "id": "BEV003",
            "name": "Iced Tea",
            "quantity": 100,
            "price": 300,
            "discount": null,
            "img_url": "img/BEV003.jpg",
            "expiration_date": "2025-08-01"
        },
        {
            "id": "BEV004",
            "name": "Coffee",
            "quantity": 100,
            "price": 400,
            "discount": null,
            "img_url": "img/BEV004.jpeg",
            "expiration_date": "2025-08-01"
        },
        {
            "id": "BEV005",
            "name": "Milkshake",
            "quantity": 100,
            "price": 500,
            "discount": null,
            "img_url": "img/BEV005.jpg",
            "expiration_date": "2025-08-01"
        }
    ]
}

let currentCategory = 'all';
let currentIndex = 0;
const itemsPerPage = 6;

function showCategory(category) {
    currentCategory = category === 'all' ? 'all' : category;
    currentIndex = 0;
    const foodItemsContainer = document.getElementById('food-items');
    foodItemsContainer.innerHTML = '';
    loadMoreItems();
}

function loadMoreItems() {
    const foodItemsContainer = document.getElementById('food-items');
    const loadingSpinner = document.getElementById('loading');
    loadingSpinner.style.display = 'block';

    setTimeout(() => {
        let itemsToLoad;

        if (currentCategory === 'all') {
            itemsToLoad = Object.values(foodItems).flat().slice(currentIndex, currentIndex + itemsPerPage);
        } else {
            itemsToLoad = foodItems[currentCategory].slice(currentIndex, currentIndex + itemsPerPage);
        }

        itemsToLoad.forEach(item => {

            const foodCard = `
                <div class="col-lg-4 mb-4 food-item" data-aos="fade-up">
                    <div class="card">
                        <img src="${item.img_url}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px;" alt="${item.name}">
                        <div class="card-body">
                            <h2 class="fw-normal">${item.name}</h2>
                            <p class="card-text">Price: LKR ${item.price}</p>
                            <p class="card-text">Discount: ${item.discount}</p>
                            <p><button class="btn btn-secondary" onclick="editItem('${item.id}')">Edit</button></p>
                        </div>
                    </div>
                </div>
            `;
            foodItemsContainer.innerHTML += foodCard;
        });

        currentIndex += itemsToLoad.length;

        loadingSpinner.style.display = 'none';

        if (currentIndex >= (currentCategory === 'all' ? Object.values(foodItems).flat().length : foodItems[currentCategory].length)) {
            window.removeEventListener('scroll', handleScroll);
        }

        AOS.init();
    }, 500);
}

function handleScroll() {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500) {
        loadMoreItems();
    }
}

const searchInput = document.querySelector('input[type="search"]');
const suggestionsList = document.createElement('div');

searchInput.addEventListener('input', function () {
    const query = this.value.toLowerCase();
    const filteredItems = itemsToLoad.filter(item => item.name.toLowerCase().includes(query));
    showSuggestions(filteredItems);
});

function showSuggestions(items) {
    if (suggestionsList) {
        suggestionsList.remove();
    }
    if (items.length === 0) return;

    suggestionsList.classList.add('suggestions', 'list-group', 'position-absolute', 'w-100');

    items.forEach(item => {
        const suggestionItem = document.createElement('button');
        suggestionItem.classList.add('list-group-item', 'list-group-item-action');
        suggestionItem.textContent = item.name;
        suggestionItem.onclick = () => {
            searchInput.value = item.name;
            suggestionsList.remove();
        };
        suggestionsList.appendChild(suggestionItem);
    });

    searchInput.parentNode.appendChild(suggestionsList);
}

function addItem() {
    const name = prompt("Enter the food name:");
    const price = prompt("Enter the price in LKR:");
    const quantity = prompt("Enter the quantity:");
    const img_url = prompt("Enter the image URL:");
    const discount = prompt("Enter the discount (leave blank if none):");

    if (name && price && quantity && img_url) {
        const newItem = {
            id: `BUR${(itemsToLoad.length + 1).toString().padStart(3, '0')}`,
            name: name,
            quantity: parseInt(quantity),
            price: parseFloat(price),
            discount: discount ? parseInt(discount) : null,
            img_url: img_url,
            expiration_date: new Date(Date.now() + 31536000000).toISOString().split('T')[0]
        };

        itemsToLoad.push(newItem);
        loadMoreItems();
    } else {
        alert("All fields are required to add a new item.");
    }
}

function editItem(id) {
    const item = itemsToLoad.find(i => i.id === id);
    if (item) {
        const name = prompt("Edit the food name:", item.name);
        const price = prompt("Edit the price in LKR:", item.price);
        const quantity = prompt("Edit the quantity:", item.quantity);
        const img_url = prompt("Edit the image URL:", item.img_url);
        const discount = prompt("Edit the discount (leave blank if none):", item.discount);

        item.name = name || item.name;
        item.price = price ? parseFloat(price) : item.price;
        item.quantity = quantity ? parseInt(quantity) : item.quantity;
        item.img_url = img_url || item.img_url;
        item.discount = discount ? parseInt(discount) : item.discount;

        loadMoreItems();
    }
}


document.addEventListener('DOMContentLoaded', function () {
    showCategory('all');
    window.addEventListener('scroll', handleScroll);
});
